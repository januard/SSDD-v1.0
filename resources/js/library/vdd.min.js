/*
|--------------------------------------------------------------------------
| Variables
|--------------------------------------------------------------------------
*/
var $ts;

/*
|--------------------------------------------------------------------------
| Functions
|--------------------------------------------------------------------------
*/

/*
 * Title
 *
 * @param xxxxx [String, Integer, Float] // Ex. "xxxxx", "xxxxx"
 * 
 * @return xxxxx [String, Integer, Float]
 *
 */
window.testFunction = function() {
    
}

/*
 * Toggle Password Visibility
 *
 * @param input [Element] // Ex. "password"
 * @param icon [Element] // Ex. "password_icon"
 *
 */
window.togglePasswordVisibility = function(input, icon) {
    document.getElementById(input).getAttribute('type') === 'password' ? [
        document.getElementById(input).setAttribute('type', 'text'), 
        document.getElementById(icon).classList.remove('fa-eye'), 
        document.getElementById(icon).classList.add('fa-eye-slash')
    ] : [
        document.getElementById(input).setAttribute('type', 'password'), 
        document.getElementById(icon).classList.remove('fa-eye-slash'), 
        document.getElementById(icon).classList.add('fa-eye')
    ];
}

/*
|--------------------------------------------------------------------------
| Initialize
|--------------------------------------------------------------------------
*/

// CSRF Token Laravel
$.ajaxSetup({
	headers: {
		'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr("content"), 
		'Authorization': 'Bearer '+ getAppDetails.api_token,
	}
});

$(document).on("click", 'a[href$="#"]', function(event) {
    event.preventDefault ? event.preventDefault() : event.returnValue = false;
});

$(function() {
	$('#logout_token').val(getAppDetails.csrf_token);
	$(document).on('click', '.side-navigation .nav-link:not(.nav-collapse-link)', function() {
		$('.side-navigation .nav-link').removeClass('active').removeClass('sub-link-active');
		let $this = $(this);
		$this.addClass('active');
		if($this.hasClass('sub-nav-link')) {
			$this.parents(':eq(3)').find('.nav-collapse-link').addClass('sub-link-active');
		}
	});
	$(document).on('click', '.edit-program-account', function() {
		$.ajax({
			type: 'GET',
			url: '/api/vdd/program/edit_program/'+ $(this).attr('data-id'), 
			success: function(response) {
				let modal = $(document).find('#modal_edit_program .modal-content');
				if(response['error_count'] == 0) {
					let data = response['data']['program'];
					$('#edit_program_id').val(data['program_id']);
					$('#edit_program').val(data['program']);
					$('#edit_program_code').val(data['code']);
					$('#edit_program_description').val(data['description']);
					modal.find('.modal-loader').addClass('d-none');
					modal.find('.content').removeClass('d-none');
				}
				else {
					alert(response['data']['message']);
					$('#modal_edit_program').modal('hide');
				}
			}, 
			error: function(response) {
				storeSystemLog('Error Log: Program Update', response);
			}
		});
	});

	$(document).on('click', '.view-program-details', function() {
		let modal = $(this).attr('data-modal');
		let object = JSON.parse($(this).attr('data'));
		for(var property in object) {
			$(modal).find('#view_'+ property).text(object[property]);
		}
		setTimeout(function() {
			$(modal +' .modal-loader').addClass('d-none');
        	$(modal +' .content').removeClass('d-none');
		}, 500);
	});

	$(document).on('click', '.view-services-application-details', function() {
		let modal = $(this).attr('data-modal');
		let object = JSON.parse($(this).attr('data'));
		for(var property in object) {
			$(modal).find('#view_'+ property).text(object[property]);
			$(modal).find('input[id="view_'+ property +'"]').val(object[property]);
		}
		setTimeout(function() {
			$(modal +' .modal-loader').addClass('d-none');
        	$(modal +' .content').removeClass('d-none');
		}, 500);
	});

	$(document).on('click', '.view-assistance-details', function() {
		let modal = $(this).attr('data-modal');
		let object = JSON.parse($(this).attr('data'));
		for(var property in object) {
			$(modal).find('#view_'+ property).text(object[property]);
		}
		setTimeout(function() {
			$(modal +' .modal-loader').addClass('d-none');
        	$(modal +' .content').removeClass('d-none');
		}, 500);
	});

	$(document).on('click', '.view-referral-details', function() {
		let modal = $(this).attr('data-modal');
		let object = JSON.parse($(this).attr('data'));
		for(var property in object) {
			$(modal).find('#view_'+ property).text(object[property]);
		}
		setTimeout(function() {
			$(modal +' .modal-loader').addClass('d-none');
        	$(modal +' .content').removeClass('d-none');
		}, 500);
	});

	$(document).on('click', '.appointment-services-application-select', function() {
		
		let _this = $(this);
		
		if(_this.hasClass('selected')) {

			$('div .appointment-services-application-select').removeClass('selected');
			
			_this.removeClass('btn-prmry selected').addClass('btn-outln-prmry');

			$('#appointment_selected_application').val('');

			$('#appointment_selected_application_value').val('');

			_this.find('span').text('Select')

		}
		else {

			$('div .appointment-services-application-select').removeClass('selected');
			
			_this.addClass('btn-outln-prmry').addClass('btn-prmry selected');

			$('#appointment_selected_application').val(_this.attr('data-id'));

			$('#appointment_selected_application_value').val(_this.attr('data'));

			_this.find('span').text('Selected')

		}
	});
	
	$(document).on('click', '.new-request-in-program', function() {
		$('#assistance_program').val($(this).attr('data-id'));
		$('#assistance_program_value').val($(this).attr('data-program'));
	});
	
});